
<!DOCTYPE html>


<html lang="en" data-content_root="" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>prepared_dataset &#8212; KnowIt 0.1 documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=5b4479735964841361fd" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=5b4479735964841361fd" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=5b4479735964841361fd" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=362ab14a" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd" />
  <script src="../../_static/vendor/fontawesome/6.1.2/js/all.min.js?digest=5b4479735964841361fd"></script>

    <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=e031e9a9"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'autoapi/prepared_dataset/index';</script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="setup_action_args" href="../setup_action_args/index.html" />
    <link rel="prev" title="fetch_torch_mods" href="../fetch_torch_mods/index.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>

  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search the docs ..."
         aria-label="Search the docs ..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
<div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
    <span class="fa-solid fa-bars"></span>
  </label>
  
  
  <div class="col-lg-3 navbar-header-items__start">
    
      <div class="navbar-item">

  

<a class="navbar-brand logo" href="../../index.html">
  
  
  
  
  
  
    <p class="title logo__title">KnowIt 0.1 documentation</p>
  
</a></div>
    
  </div>
  
  <div class="col-lg-9 navbar-header-items">
    
    <div class="me-auto navbar-header-items__center">
      
        <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
      
    </div>
    
    
    <div class="navbar-header-items__end">
      
        <div class="navbar-item navbar-persistent--container">
          

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
        </div>
      
      
        <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
      
    </div>
    
  </div>
  
  
    <div class="navbar-persistent--mobile">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script>
    </div>
  

  
    <label class="sidebar-toggle secondary-toggle" for="__secondary" tabindex="0">
      <span class="fa-solid fa-outdent"></span>
    </label>
  
</div>

    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
        
          <div class="navbar-item">
<nav class="navbar-nav">
  <p class="sidebar-header-items__title"
     role="heading"
     aria-level="1"
     aria-label="Site Navigation">
    Site Navigation
  </p>
  <ul class="bd-navbar-elements navbar-nav">
    
                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="../index.html">
                        API Reference
                      </a>
                    </li>
                
  </ul>
</nav></div>
        
      </div>
    
    
    
      <div class="sidebar-header-items__end">
        
          <div class="navbar-item">

<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script></div>
        
      </div>
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
<nav class="bd-docs-nav bd-links"
     aria-label="Section Navigation">
  <p class="bd-links__title" role="heading" aria-level="1">Section Navigation</p>
  <div class="bd-toc-item navbar-nav"><ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../viz/index.html">viz</a></li>
<li class="toctree-l1"><a class="reference internal" href="../TCN/index.html">TCN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MLP/index.html">MLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../CNN/index.html">CNN</a></li>
<li class="toctree-l1"><a class="reference internal" href="../conf/index.html">conf</a></li>
<li class="toctree-l1"><a class="reference internal" href="../knowit/index.html">knowit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../logger/index.html">logger</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trainer/index.html">trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_user/index.html">env_user</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DL_Captum/index.html">DL_Captum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../env_paths/index.html">env_paths</a></li>
<li class="toctree-l1"><a class="reference internal" href="../DLS_Captum/index.html">DLS_Captum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../featureattr/index.html">featureattr</a></li>
<li class="toctree-l1"><a class="reference internal" href="../interpreter/index.html">interpreter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_config/index.html">model_config</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base_trainer/index.html">base_trainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../base_dataset/index.html">base_dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_scaling/index.html">data_scaling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../trainer_states/index.html">trainer_states</a></li>
<li class="toctree-l1"><a class="reference internal" href="../file_dir_procs/index.html">file_dir_procs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../data_splitting/index.html">data_splitting</a></li>
<li class="toctree-l1"><a class="reference internal" href="../fetch_torch_mods/index.html">fetch_torch_mods</a></li>
<li class="toctree-l1 current active"><a class="current reference internal" href="#">prepared_dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup_action_args/index.html">setup_action_args</a></li>
<li class="toctree-l1"><a class="reference internal" href="../regression_dataset/index.html">regression_dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../raw_data_coversion/index.html">raw_data_coversion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../import_custom_arch/index.html">import_custom_arch</a></li>
<li class="toctree-l1"><a class="reference internal" href="../penguin_grid_search/index.html">penguin_grid_search</a></li>
<li class="toctree-l1"><a class="reference internal" href="../IntegratedGrad_Captum/index.html">IntegratedGrad_Captum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../classification_dataset/index.html">classification_dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dummy_runner_regression/index.html">dummy_runner_regression</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dummy_runner_classification/index.html">dummy_runner_classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../NITheCS_synth_demo_bad_model/index.html">NITheCS_synth_demo_bad_model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../select_interpretation_points/index.html">select_interpretation_points</a></li>
<li class="toctree-l1"><a class="reference internal" href="../setup_weighted_cross_entropy/index.html">setup_weighted_cross_entropy</a></li>
</ul>
</div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        
          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item">



<nav aria-label="Breadcrumb">
  <ul class="bd-breadcrumbs">
    
    <li class="breadcrumb-item breadcrumb-home">
      <a href="../../index.html" class="nav-link" aria-label="Home">
        <i class="fa-solid fa-home"></i>
      </a>
    </li>
    
    <li class="breadcrumb-item"><a href="../index.html" class="nav-link">API Reference</a></li>
    
    <li class="breadcrumb-item active" aria-current="page">prepared_dataset</li>
  </ul>
</nav>
</div>
      
    </div>
  
  
</div>
</div>
              
              
              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <section id="module-prepared_dataset">
<span id="prepared-dataset"></span><h1>prepared_dataset<a class="headerlink" href="#module-prepared_dataset" title="Permalink to this heading">#</a></h1>
<section id="attributes">
<h2>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#prepared_dataset.__author__" title="prepared_dataset.__author__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__author__</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#prepared_dataset.__description__" title="prepared_dataset.__description__"><code class="xref py py-obj docutils literal notranslate"><span class="pre">__description__</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#prepared_dataset.logger" title="prepared_dataset.logger"><code class="xref py py-obj docutils literal notranslate"><span class="pre">logger</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="classes">
<h2>Classes<a class="headerlink" href="#classes" title="Permalink to this heading">#</a></h2>
<table class="autosummary longtable table autosummary">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#prepared_dataset.PreparedDataset" title="prepared_dataset.PreparedDataset"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PreparedDataset</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</section>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this heading">#</a></h2>
<dl class="py data">
<dt class="sig sig-object py" id="prepared_dataset.__author__">
<span class="sig-prename descclassname"><span class="pre">prepared_dataset.</span></span><span class="sig-name descname"><span class="pre">__author__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'tiantheunissen&#64;gmail.com'</span></em><a class="headerlink" href="#prepared_dataset.__author__" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="prepared_dataset.__description__">
<span class="sig-prename descclassname"><span class="pre">prepared_dataset.</span></span><span class="sig-name descname"><span class="pre">__description__</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">'Contains</span> <span class="pre">the</span> <span class="pre">PreparedDataset</span> <span class="pre">class</span> <span class="pre">for</span> <span class="pre">Knowit.'</span></em><a class="headerlink" href="#prepared_dataset.__description__" title="Permalink to this definition">#</a></dt>
<dd><section id="prepareddataset">
<h3>PreparedDataset<a class="headerlink" href="#prepareddataset" title="Permalink to this heading">#</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">PreparedDataset</span></code> represents a BaseDataset that is preprocessed for model training.
It inherits from BaseDataset. Based on the provided <a href="#id1"><span class="problematic" id="id2">`</span></a>name’ variable, it will populate the
parent BaseDataset’s variables.</p>
</section>
<section id="prediction-points">
<h3>Prediction points<a class="headerlink" href="#prediction-points" title="Permalink to this heading">#</a></h3>
<p>In order to define a PreparedDataset, the input-output dynamics of the model to be trained
must defined rather precisely. The PreparedDataset is built on the idea of ‘prediction points’.
Each time step in the BaseDataset can be regarded a prediction point (under some assumptions).
At every prediction point, a model is to predict a specific set of features-over-time from
a specific other set of features-over-time. The specifics are defined as follows.</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>in_components (list): A subset of the ‘components’ variable of the BaseDataset.</dt><dd><p>These are the components that will be used as input to the model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>out_components (list): A subset of the ‘components’ variable of the BaseDataset.</dt><dd><p>These are the components that will be used as output to the model.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>in_chunk (list): A list of two integers [a, b] for which a &lt;= b. This defines the</dt><dd><p>time steps (of in_components) to be used for prediction at point
t as [t + a, t + b].</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>out_chunk (list): A list of two integers [a, b] for which a &lt;= b. This defines the</dt><dd><p>time steps (of out_components) to be predicted at prediction point
t as [t + a, t + b].</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<p>Note that this might seem cumbersome, but it allows us to easily define many different types of tasks:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>regression (heartrate from 11 millisecond window given three instantaneous biometrics)</dt><dd><p>in_components = [biometric1, biometric2, biometric2]
out_components = [heart rate]
in_chunk = [-5, 5]
out_chunk = [0, 0]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>autoregressive univariate forcasting (predict a stock’s value in 5 days given last 20 days)</dt><dd><p>in_components = [stock,]
out_components = [stock,]
in_chunk = [-20, 0]
out_chunk = [5, 5]</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>time series classification (detect a whale call given an audio recording of 5 seconds)</dt><dd><p>in_components = [sound,]
out_components = [positive_call,]
in_chunk = [-2, 2]
out_chunk = [0, 0]</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</section>
<section id="input-arguments">
<h3>Input arguments<a class="headerlink" href="#input-arguments" title="Permalink to this heading">#</a></h3>
<p>In addition to the dataset name and prediction point dynamics defined above, the following variables
should also be provided.</p>
<ul class="simple">
<li><dl class="simple">
<dt>name (str): The name of the new dataset option.</dt><dd><ul>
<li><dl class="simple">
<dt>split_portions (tuple): The approximate portions of the (train, valid, eval) splits.</dt><dd><p>Note these portions are considered in combination with the split_method.</p>
</dd>
</dl>
</li>
<li><p>seed (int): The seed for reproducibility.</p></li>
<li><p>batch_size (int): The mini-batch size for training.</p></li>
<li><dl class="simple">
<dt>shuffle_train (bool, optional): Whether the training set is shuffled after every epoch.</dt><dd><p>Default: True</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>split_method (str, optional): The method of splitting data. See below for details.</dt><dd><p>Default: ‘chronological’</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>limit (int, optional): The number of instances / slices / time steps to limit</dt><dd><p>the data to. This depends on the split_method.
Default: None = no limit.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>scaling_method (str, optional): What method to use for scaling the data features.</dt><dd><p>See below for details. Default: z-norm</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>scaling_tag (str, optional): In what mode to scale the data. (in_only, full, None)</dt><dd><p>See below for details. Default: None</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>padding_method (str, optional): What method to pad model inputs will.</dt><dd><p>See below for details. Default: zero</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>min_slice (str, optional): The minimum slice size to consider</dt><dd><p>during data splitting / selection. Default: None = Consider all slices</p>
</dd>
</dl>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</section>
<section id="splitting-limiting">
<h3>Splitting &amp; Limiting<a class="headerlink" href="#splitting-limiting" title="Permalink to this heading">#</a></h3>
<p>The first step in preparing the dataset is to split it into a train-, validation-,
and evaluation set (train, valid, eval) along with limiting it if applicable.
This is done with the DataSplitter module.  More details can be found there,
but we summarize the options here:
- <cite>split_method</cite> =</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt>‘random’: Ignore all distinction between instances and slices,</dt><dd><p>and split on time steps randomly.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘chronological’ (default): Ignore all distinction between instances and slices,</dt><dd><p>and split on time steps chronologically.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘slice-random’: Ignore all distinction between instances,</dt><dd><p>and split on slices randomly.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt>‘slice-chronological’: Ignore all distinction between instances,</dt><dd><p>and split on slices chronologically.</p>
</dd>
</dl>
</li>
<li><p>‘instance-random’: Split on instances randomly.</p></li>
<li><p>‘instance-chronological’: Split on instances chronologically.</p></li>
</ul>
</div></blockquote>
<p>Note that the data is split ON the relevant level (instance, slice, or timesteps).
I.e. If you split on instances and there are only 3 instances, then split_portions=(0.6, 0.2, 0.2)
will be a wild approximation i.t.o actual time steps.</p>
<p>Note that the data is limited during splitting, and the data is limited by removing
the excess data points from the end of the data block after shuffling or ordering according to time.
Also note that if the data is limited too much for a given split_portion to have a single entry,</p>
<blockquote>
<div><p>an error will occur confirming it.</p>
</div></blockquote>
</section>
<section id="scaling">
<h3>Scaling<a class="headerlink" href="#scaling" title="Permalink to this heading">#</a></h3>
<p>After the data is split and limited, a scaler is fit to the train set data
which will be applied to all data being extracted for model training.
This is done with the DataScaler module.
More details can be found there, but we summarize the options here:
- <cite>scaling_method</cite></p>
<blockquote>
<div><ul class="simple">
<li><p>‘z-norm’: Features are scaled by subtracting the mean and dividing by the std.</p></li>
<li><p>‘zero-one’: Input features are scaled linearly to be in the range (0, 1).</p></li>
<li><p>None: No scaling occurs.</p></li>
</ul>
</div></blockquote>
<p>If the task is regression, then the scaling also applies to the output features.
- <cite>scaling_tag</cite></p>
<blockquote>
<div><ul class="simple">
<li><p>‘in_only’: Only the input features will be scaled.</p></li>
<li><p>‘full’: The in and output features will be scaled.</p></li>
<li><p>None: No features will be scaled.</p></li>
</ul>
</div></blockquote>
</section>
<section id="padding">
<h3>Padding<a class="headerlink" href="#padding" title="Permalink to this heading">#</a></h3>
<p>At some prediction points the <a href="#id3"><span class="problematic" id="id4">`</span></a>in_chunk’ or ‘out_chunk’ might exceed the corresponding
slice range. In these cases we pad the input values. The output values are never padded.
Prediction points that do not have valid output values for an ‘out_chunk’ are not selected
during data splitting. The argument <a href="#id5"><span class="problematic" id="id6">`</span></a>padding_method’ is the same as ‘mode’ in the numpy.pad
function (<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html">https://numpy.org/doc/stable/reference/generated/numpy.pad.html</a>).</p>
</section>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="prepared_dataset.logger">
<span class="sig-prename descclassname"><span class="pre">prepared_dataset.</span></span><span class="sig-name descname"><span class="pre">logger</span></span><a class="headerlink" href="#prepared_dataset.logger" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">prepared_dataset.</span></span><span class="sig-name descname"><span class="pre">PreparedDataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <code class="xref py py-obj docutils literal notranslate"><span class="pre">data.base_dataset.BaseDataset</span></code></p>
<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.__setattr_or_default">
<span class="sig-name descname"><span class="pre">__setattr_or_default</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">args</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">default</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">object</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.__setattr_or_default" title="Permalink to this definition">#</a></dt>
<dd><p>Set object attribute with given (if given) or given default.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.__prepare">
<span class="sig-name descname"><span class="pre">__prepare</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.__prepare" title="Permalink to this definition">#</a></dt>
<dd><p>Prepare the dataset by splitting and scaling the data.
Note that this is not done directly on the data. The splits are defined in the
‘selection’ variable in a selection matrix.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.get_ist_values">
<span class="sig-name descname"><span class="pre">get_ist_values</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.get_ist_values" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.extract_dataset">
<span class="sig-name descname"><span class="pre">extract_dataset</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">set_tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.extract_dataset" title="Permalink to this definition">#</a></dt>
<dd><p>Extracts the relevant samples for one of the data splits, scale them, and package them.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.__fast_extract">
<span class="sig-name descname"><span class="pre">__fast_extract</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">the_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">set_tag</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.__fast_extract" title="Permalink to this definition">#</a></dt>
<dd><p>Pad relevant slices. And sample the input values (padded)
and output values (not padded).</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.__parr_sample">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__parr_sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">selection</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">in_chunk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">out_chunk</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_pad</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">padded_slices</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">the_data</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">instances</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_map</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.__parr_sample" title="Permalink to this definition">#</a></dt>
<dd><p>Sample data blocks for parallel processing based on selection indices.</p>
<p>This function samples data blocks from the provided inputs according to the selection indices. It samples blocks
from the input data and the target data for parallel processing.</p>
<dl class="simple">
<dt>Parameters:</dt><dd><p>selection (array-like): Selection indices specifying the data blocks to sample.
in_chunk (tuple): Input data chunk size.
out_chunk (tuple): Target data chunk size.
max_pad (int): Maximum padding for input data blocks.
padded_slices (dict): Dictionary containing padded slices of the input data.
the_data (list): List containing the input data instances.
instances (list): List of instances related to the input data.
y_map (array): Mapping for target data components.</p>
</dd>
<dt>Returns:</dt><dd><p>x_vals (array-like): Sampled input data blocks.
y_vals (array-like): Sampled target data blocks.</p>
</dd>
</dl>
<p>Internal Function:
sample_blocks(t, chunk, pad):</p>
<blockquote>
<div><p>Helper function for sampling blocks of data along a given axis.</p>
</div></blockquote>
<p>The function samples data blocks from the specified inputs based on the selection indices, and returns the
sampled input and target data as arrays.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.__do_padding">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__do_padding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">vals</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">numpy.array</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">direction</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.__do_padding" title="Permalink to this definition">#</a></dt>
<dd><p>Pad vals = [timesteps, features] using the
given method in the given direction up to the given size (cap).
See <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.pad.html">https://numpy.org/doc/stable/reference/generated/numpy.pad.html</a>.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="prepared_dataset.PreparedDataset.__required_prepared_meta">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">__required_prepared_meta</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#prepared_dataset.PreparedDataset.__required_prepared_meta" title="Permalink to this definition">#</a></dt>
<dd><p>These are the variables (and their formats) that need to be given
when creating a new PreparedDataset object.</p>
</dd></dl>

</dd></dl>

</section>
</section>


                </article>
              
              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="../fetch_torch_mods/index.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">fetch_torch_mods</p>
      </div>
    </a>
    <a class="right-next"
       href="../setup_action_args/index.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">setup_action_args</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">

  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#attributes">Attributes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#classes">Classes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#module-contents">Module Contents</a><ul class="visible nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.__author__"><code class="docutils literal notranslate"><span class="pre">__author__</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.__description__"><code class="docutils literal notranslate"><span class="pre">__description__</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.logger"><code class="docutils literal notranslate"><span class="pre">logger</span></code></a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset"><code class="docutils literal notranslate"><span class="pre">PreparedDataset</span></code></a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.__setattr_or_default"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.__setattr_or_default()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.__prepare"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.__prepare()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.get_ist_values"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.get_ist_values()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.extract_dataset"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.extract_dataset()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.__fast_extract"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.__fast_extract()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.__parr_sample"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.__parr_sample()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.__do_padding"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.__do_padding()</span></code></a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#prepared_dataset.PreparedDataset.__required_prepared_meta"><code class="docutils literal notranslate"><span class="pre">PreparedDataset.__required_prepared_meta()</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
  </nav></div>

  <div class="sidebar-secondary-item">

  <div class="tocsection sourcelink">
    <a href="../../_sources/autoapi/prepared_dataset/index.rst.txt">
      <i class="fa-solid fa-file-lines"></i> Show Source
    </a>
  </div>
</div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
          </footer>
        
      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=5b4479735964841361fd"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=5b4479735964841361fd"></script>

  <footer class="bd-footer">
<div class="bd-footer__inner bd-page-width">
  
    <div class="footer-items__start">
      
        <div class="footer-item">

  <p class="copyright">
    
      © Copyright 2024, Tian Theunissen, Randle Rabe.
      <br/>
    
  </p>
</div>
      
        <div class="footer-item">

  <p class="sphinx-version">
    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 7.1.2.
    <br/>
  </p>
</div>
      
    </div>
  
  
  
    <div class="footer-items__end">
      
        <div class="footer-item">
<p class="theme-version">
  Built with the <a href="https://pydata-sphinx-theme.readthedocs.io/en/stable/index.html">PyData Sphinx Theme</a> 0.14.4.
</p></div>
      
    </div>
  
</div>

  </footer>
  </body>
</html>